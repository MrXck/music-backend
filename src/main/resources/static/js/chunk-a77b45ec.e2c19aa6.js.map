{"version":3,"sources":["webpack:///./src/views/AdminSongListUpdate.vue","webpack:///./src/views/AdminSongListUpdate.vue?936f","webpack:///./src/views/AdminSongListUpdate.vue?04db"],"names":["_createBlock","_component_n_space","vertical","align","_createVNode","_component_n_input","value","$setup","name","$event","type","_component_n_avatar","size","src","imgSrc","_component_n_button","onClick","_createElementVNode","ref","class","onChange","_component_n_select","filterable","options","multiple","__exports__","render"],"mappings":"8KAA8F,S,+BAAkS,Q,+BAAyK,S,+BAA+M,U,+BAAuN,M,wRAA18BA,yBAAy/BC,EAAA,CAAh/BC,SAAA,GAASC,MAAM,SAAxB,C,6BAAyC,IAA0J,CAA1JC,yBAA0JH,EAAA,CAAjJC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA6B,4BAA0DG,EAAA,CAAzCC,MAAOC,iBAAeC,K,gCAAfD,iBAAeC,KAAIC,GAAEC,KAAK,QAAlD,oB,MAAsFN,yBAA+RH,EAAA,CAAtRC,SAAA,GAASC,MAAM,UAAxB,C,6BAA8C,IAAuF,CAAvFC,yBAAuFO,EAAA,CAA5EC,KAAM,IAAMC,IAAKN,iBAAeO,OAAS,eAAcP,YAAlE,+BAAoGH,yBAA4CW,EAAA,CAAjCC,QAAOT,aAAS,C,6BAAE,IAAI,K,KAAjC,eAAyDU,gCAAiE,SAA1DC,IAAI,OAAOR,KAAK,OAAOS,MAAM,SAAUC,SAAM,oBAAEb,iCAAtD,Y,MAA6FH,yBAAsMH,EAAA,CAA7LC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA6B,4BAAsGmB,EAAA,CAA5FC,WAAA,GAAY,iBAAY,CAAEf,gBAAF,eAAgCA,UAAOE,IAAdH,MAAOC,UAAUgB,QAAShB,kBAArF,+C,MAAkIH,yBAAgMH,EAAA,CAAvLC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA8B,4BAA+FmB,EAAA,CAArFC,WAAA,GAAWE,SAAA,GAAU,iBAAY,CAAEjB,SAAF,eAAyBA,QAAKE,IAAZH,MAAOC,QAAQgB,QAAShB,WAArF,+C,MAA2HH,yBAA8FH,EAAA,M,6BAAxE,IAAqD,CAArDG,yBAAqDW,EAAA,CAA1CC,QAAOT,wBAAoB,C,6BAAE,IAAE,K,KAA1C,iB,2zDCOv6B,MAAMkB,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E,gB,oCCTf,W","file":"js/chunk-a77b45ec.e2c19aa6.js","sourcesContent":["<template>\r    <n-space vertical align=\"start\">\r        <n-space vertical item-style=\"min-width: 200px\">\r            歌单名\r            <n-input v-model:value=\"songListDetail.name\" type=\"text\"/>\r        </n-space>\r        <n-space vertical align=\"center\">\r            <n-avatar :size=\"200\" :src=\"songListDetail.imgSrc\" :fallback-src=\"notImage\"></n-avatar>\r            <n-button @click=\"chooseImg\">修改头像</n-button>\r            <input ref=\"file\" type=\"file\" class=\"hidden\" @change=\"uploadImg\">\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            创建者\r            <n-select filterable @update:value=\"updateCreator\" v-model:value=\"creator\" :options=\"creatorOptions\"/>\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            选择歌曲\r            <n-select filterable multiple @update:value=\"update\" v-model:value=\"value\" :options=\"options\"/>\r        </n-space>\r        <n-space>\r            <n-button @click=\"updateSongListDetail\">提交</n-button>\r        </n-space>\r    </n-space>\r</template>\r\r<script>\rimport notImage from '../assets/notImage.jpg'\rimport {NSpace, NInput, NAvatar, NButton, useMessage, NSelect} from 'naive-ui'\rimport {useRoute} from 'vue-router'\rimport {getCurrentInstance, onMounted, reactive, ref} from 'vue'\rimport request from '../utils/request'\r\rexport default {\r    name: 'AdminSongListUpdate',\r    components: {NSpace, NInput, NAvatar, NButton, NSelect},\r    setup() {\r        const route = useRoute()\r        let file;\r        let message = useMessage()\r        let songListDetail = ref({\r            id: '',\r            name: '',\r            imgSrc: '',\r            songs: []\r        })\r        let songs = []\r        let options = reactive([])\r        let creatorOptions = reactive([])\r        let value = reactive([])\r        let creator = ref('')\r\r        let id = route.query.id\r\r        function init() {\r            request.get('/admin/user/all').then(res => {\r                if (res.data.code === 0) {\r                    for (let i = 0; i < res.data.data.length; i++) {\r                        creatorOptions.push({\r                            label: res.data.data[i].username,\r                            value: res.data.data[i].id,\r                        })\r                    }\r                }\r            })\r        }\r\r        onMounted(() => {\r            init()\r            file = getCurrentInstance().refs.file\r            if (id !== undefined) {\r                request.get('/songList/' + id).then(res => {\r                    if (res.data.code === 0) {\r                        songListDetail.value = res.data.data\r                        songs = res.data.data.songs\r                        for (let i = 0; i < songs.length; i++) {\r                            options.push({\r                                label: songs[i].name + ' 歌手:' + songs[i].singers[0].name,\r                                value: songs[i].id,\r                            })\r                            value.push(songs[i].id)\r                        }\r                    }\r                })\r            }\r        })\r\r        function uploadImg() {\r            if (!(file.files[0].type === \"image/png\") && !(file.files[0].type === \"image/jpeg\")) {\r                message.error(\"只能上传png/jpeg格式的图片文件，请重新上传\")\r                return false\r            }\r            if (!(file.files[0].size / 1024 / 1024 < 2)) {\r                message.error('上传头像图片大小不能超过 2MB!');\r                return false\r            }\r            const param = new FormData()\r            param.append('file', file.files[0])\r            request.post('/file/uploadAvatar', param, {headers: {\"Content-Type\": \"multipart/form-data\"}}).then(res => {\r                if (res.data.code === 0) {\r                    songListDetail.value.imgSrc = res.data.data\r                }\r            })\r        }\r\r        function chooseImg() {\r            file.click()\r        }\r\r        function updateSongListDetail() {\r            let songList = []\r            for (let i = 0; i < value.length; i++) {\r                songList.push(songs.find(item => {\r                    return item.id === value[i]\r                }))\r            }\r            songListDetail.value.creator = creator.value\r            request.post('/songList/update', songListDetail.value).then(res => {\r                if (res.data.code === 0) {\r                    message.success('修改成功')\r                } else {\r                    message.error('修改失败')\r                }\r            })\r        }\r\r        function update(val) {\r            value.length = 0\r            value.push(...val)\r        }\r\r        function updateCreator(val) {\r            console.log(val)\r            creator.value = val\r        }\r\r        return {\r            notImage,\r            songListDetail,\r            options,\r            creatorOptions,\r            value,\r            creator,\r\r            chooseImg,\r            uploadImg,\r            update,\r            updateSongListDetail,\r            updateCreator,\r        }\r    }\r}\r</script>\r\r<style scoped>\r.hidden {\r    display: none;\r}\r</style>\r","import { render } from \"./AdminSongListUpdate.vue?vue&type=template&id=69344d58&scoped=true\"\nimport script from \"./AdminSongListUpdate.vue?vue&type=script&lang=js\"\nexport * from \"./AdminSongListUpdate.vue?vue&type=script&lang=js\"\n\nimport \"./AdminSongListUpdate.vue?vue&type=style&index=0&id=69344d58&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\xck\\\\Desktop\\\\music-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-69344d58\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AdminSongListUpdate.vue?vue&type=style&index=0&id=69344d58&scoped=true&lang=css\""],"sourceRoot":""}