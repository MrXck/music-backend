{"version":3,"sources":["webpack:///./src/views/AdminSingerUpdate.vue","webpack:///./src/views/AdminSingerUpdate.vue?86df","webpack:///./src/views/AdminSingerUpdate.vue?2597"],"names":["_createElementVNode","_createBlock","_component_n_space","vertical","align","_createVNode","_hoisted_1","_component_n_input","value","$setup","name","$event","type","_component_n_avatar","size","src","imgSrc","_component_n_button","onClick","ref","class","onChange","_component_n_select","filterable","multiple","options","__exports__","render"],"mappings":"4OAA2GA,gCAAgB,YAAV,OAAG,I,+BAAqR,Q,+BAAyK,U,+BAAqN,M,wRAAlwBC,yBAAizBC,EAAA,CAAxyBC,SAAA,GAASC,MAAM,SAAxB,C,6BAAyC,IAAqK,CAArKC,yBAAqKH,EAAA,CAA5JC,SAAA,GAAS,aAAW,oBAA7B,C,6BAA6D,IAAgB,CAAhBG,EAA6BD,yBAAwDE,EAAA,CAAvCC,MAAOC,eAAaC,K,gCAAbD,eAAaC,KAAIC,GAAEC,KAAK,QAAhD,oB,MAAoFP,yBAA6RH,EAAA,CAApRC,SAAA,GAASC,MAAM,UAAxB,C,6BAA8C,IAAqF,CAArFC,yBAAqFQ,EAAA,CAA1EC,KAAM,IAAMC,IAAKN,eAAaO,OAAS,eAAcP,YAAhE,+BAAkGJ,yBAA4CY,EAAA,CAAjCC,QAAOT,aAAS,C,6BAAE,IAAI,K,KAAjC,eAAyDT,gCAAiE,SAA1DmB,IAAI,OAAOP,KAAK,OAAOQ,MAAM,SAAUC,SAAM,oBAAEZ,iCAAtD,Y,MAA6FJ,yBAAgMH,EAAA,CAAvLC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA8B,4BAA+FmB,EAAA,CAArFC,WAAA,GAAWC,SAAA,GAAU,iBAAY,CAAEf,SAAF,eAAyBA,QAAKE,IAAZH,MAAOC,QAAQgB,QAAShB,WAArF,+C,MAA2HJ,yBAA4FH,EAAA,M,6BAAtE,IAAmD,CAAnDG,yBAAmDY,EAAA,CAAxCC,QAAOT,sBAAkB,C,6BAAE,IAAE,K,KAAxC,iB,8jDCOjuB,MAAMiB,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E,gB,2DCTf","file":"js/chunk-6c1371e0.cfe26eb4.js","sourcesContent":["<template>\r    <n-space vertical align=\"start\">\r        <n-space vertical item-style=\"min-width: 200px\">\r            <span>歌手名</span>\r            <n-input v-model:value=\"singerDetail.name\" type=\"text\"/>\r        </n-space>\r        <n-space vertical align=\"center\">\r            <n-avatar :size=\"200\" :src=\"singerDetail.imgSrc\" :fallback-src=\"notImage\"></n-avatar>\r            <n-button @click=\"chooseImg\">修改头像</n-button>\r            <input ref=\"file\" type=\"file\" class=\"hidden\" @change=\"uploadImg\">\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            选择歌曲\r            <n-select filterable multiple @update:value=\"update\" v-model:value=\"value\" :options=\"options\"/>\r        </n-space>\r        <n-space>\r            <n-button @click=\"updateSingerDetail\">提交</n-button>\r        </n-space>\r    </n-space>\r</template>\r\r<script>\rimport notImage from '../assets/notImage.jpg'\rimport {NSpace, NInput, NAvatar, NButton, useMessage, NSelect} from 'naive-ui'\rimport {useRoute} from 'vue-router'\rimport {getCurrentInstance, onMounted, reactive} from 'vue'\rimport request from '../utils/request'\r\rexport default {\r    name: 'AdminUpdateSinger',\r    components: {NSpace, NInput, NAvatar, NButton, NSelect},\r    setup(){\r        const route = useRoute()\r        let file;\r        let message = useMessage()\r        let singerDetail = reactive({\r            id: '',\r            name: '',\r            imgSrc: '',\r            songs: []\r        })\r        let songs = []\r        let options = reactive([])\r        let value = reactive([])\r\r        let id = route.query.id\r\r        function init(){\r            request.get()\r        }\r\r        onMounted(() => {\r            file = getCurrentInstance().refs.file\r            if(id !== undefined){\r                request.get('/singer/' + id).then(res => {\r                    if (res.data.code === 0){\r                        singerDetail.name = res.data.data.singer.name\r                        singerDetail.id = res.data.data.singer.id\r                        singerDetail.imgSrc = res.data.data.singer.imgSrc\r                        songs = res.data.data.songs\r                        for (let i = 0; i < songs.length; i++) {\r                            options.push({\r                                label: songs[i].name + ' 歌手:' + songs[i].singers[0].name,\r                                value: songs[i].id,\r                            })\r                            value.push(songs[i].id)\r                        }\r                    }\r                })\r            }\r        })\r\r        function uploadImg() {\r            if (!(file.files[0].type === \"image/png\") && !(file.files[0].type === \"image/jpeg\")) {\r                message.error(\"只能上传png/jpeg格式的图片文件，请重新上传\")\r                return false\r            }\r            if (!(file.files[0].size / 1024 / 1024 < 2)) {\r                message.error('上传头像图片大小不能超过 2MB!');\r                return false\r            }\r            const param = new FormData()\r            param.append('file', file.files[0])\r            request.post('/file/uploadAvatar', param, {headers: {\"Content-Type\": \"multipart/form-data\"}}).then(res => {\r                console.log(res.data)\r                if (res.data.code === 0) {\r                    singerDetail.imgSrc = res.data.data\r                }\r            })\r        }\r\r        function chooseImg() {\r            file.click()\r        }\r\r        function updateSingerDetail() {\r            let songList = []\r            for (let i = 0; i < value.length; i++) {\r                songList.push(songs.find(item => {\r                    return item.id === value[i]\r                }))\r            }\r            request.post('/admin/singer/update', singerDetail).then(res => {\r                if (res.data.code === 0) {\r                    message.success('修改成功')\r                } else {\r                    message.error('修改失败')\r                }\r            })\r        }\r\r        function update(val){\r            value.length = 0\r            value.push(...val)\r        }\r\r        return {\r            notImage,\r            singerDetail,\r            options,\r            value,\r\r            chooseImg,\r            uploadImg,\r            update,\r            updateSingerDetail,\r        }\r    }\r}\r</script>\r\r<style scoped>\r.hidden {\r    display: none;\r}\r</style>\r","import { render } from \"./AdminSingerUpdate.vue?vue&type=template&id=a4362a12&scoped=true\"\nimport script from \"./AdminSingerUpdate.vue?vue&type=script&lang=js\"\nexport * from \"./AdminSingerUpdate.vue?vue&type=script&lang=js\"\n\nimport \"./AdminSingerUpdate.vue?vue&type=style&index=0&id=a4362a12&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\xck\\\\Desktop\\\\music-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a4362a12\"]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AdminSingerUpdate.vue?vue&type=style&index=0&id=a4362a12&scoped=true&lang=css\""],"sourceRoot":""}