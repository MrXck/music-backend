{"version":3,"sources":["webpack:///./src/views/AdminSongUpdate.vue?c529","webpack:///./src/views/AdminSongUpdate.vue","webpack:///./src/views/AdminSongUpdate.vue?5ea9"],"names":["_createBlock","_component_n_space","vertical","align","_createVNode","_component_n_input","value","$setup","name","$event","type","src","time","_component_n_avatar","size","imgSrc","_component_n_button","onClick","_createElementVNode","ref","class","onChange","_component_n_select","filterable","multiple","options","lyric","__exports__","render"],"mappings":"kHAAA,W,qHCA8F,S,+BAA+J,U,+BAA+J,U,+BAA6R,Q,+BAAyK,U,+BAAyM,Q,+BAAsL,M,wRAA5tCA,yBAA2wCC,EAAA,CAAlwCC,SAAA,GAASC,MAAM,SAAxB,C,6BAAyC,IAAsJ,CAAtJC,yBAAsJH,EAAA,CAA7IC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA6B,4BAAsDG,EAAA,CAArCC,MAAOC,aAAWC,K,gCAAXD,aAAWC,KAAIC,GAAEC,KAAK,QAA9C,oB,MAAkFN,yBAAsJH,EAAA,CAA7IC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA8B,4BAAqDG,EAAA,CAApCC,MAAOC,aAAWI,I,gCAAXJ,aAAWI,IAAGF,GAAEC,KAAK,QAA7C,oB,MAAiFN,yBAAyJH,EAAA,CAAhJC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA8B,4BAAwDG,EAAA,CAAvCC,MAAOC,aAAWK,K,gCAAXL,aAAWK,KAAIH,GAAEC,KAAK,UAA9C,oB,MAAoFN,yBAA2RH,EAAA,CAAlRC,SAAA,GAASC,MAAM,UAAxB,C,6BAA8C,IAAmF,CAAnFC,yBAAmFS,EAAA,CAAxEC,KAAM,IAAMH,IAAKJ,aAAWQ,OAAS,eAAcR,YAA9D,+BAAgGH,yBAA4CY,EAAA,CAAjCC,QAAOV,aAAS,C,6BAAE,IAAI,K,KAAjC,eAAyDW,gCAAiE,SAA1DC,IAAI,OAAOT,KAAK,OAAOU,MAAM,SAAUC,SAAM,oBAAEd,iCAAtD,Y,MAA6FH,yBAAgMH,EAAA,CAAvLC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA8B,4BAA+FoB,EAAA,CAArFC,WAAA,GAAWC,SAAA,GAAU,iBAAY,CAAEjB,SAAF,eAAyBA,QAAKE,IAAZH,MAAOC,QAAQkB,QAASlB,WAArF,+C,MAA2HH,yBAAmKH,EAAA,CAA1JC,SAAA,GAAS,aAAW,oBAA7B,C,6BAAgD,IAA4B,4BAAoEG,EAAA,CAA3DK,KAAK,WAAmBJ,MAAOC,aAAWmB,M,gCAAXnB,aAAWmB,MAAKjB,IAAxD,oB,MAAgGL,yBAA0FH,EAAA,M,6BAApE,IAAiD,CAAjDG,yBAAiDY,EAAA,CAAtCC,QAAOV,oBAAgB,C,6BAAE,IAAE,K,KAAtC,iB,6lDCO7rC,MAAMoB,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,GAAQ,CAAC,YAAY,qBAE1E","file":"js/chunk-37ebb987.d6801af9.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./AdminSongUpdate.vue?vue&type=style&index=0&id=44059161&scoped=true&lang=css\"","<template>\r    <n-space vertical align=\"start\">\r        <n-space vertical item-style=\"min-width: 200px\">\r            歌曲名\r            <n-input v-model:value=\"songDetail.name\" type=\"text\"/>\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            歌曲路径\r            <n-input v-model:value=\"songDetail.src\" type=\"text\"/>\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            歌曲时间\r            <n-input v-model:value=\"songDetail.time\" type=\"number\"/>\r        </n-space>\r        <n-space vertical align=\"center\">\r            <n-avatar :size=\"200\" :src=\"songDetail.imgSrc\" :fallback-src=\"notImage\"></n-avatar>\r            <n-button @click=\"chooseImg\">修改头像</n-button>\r            <input ref=\"file\" type=\"file\" class=\"hidden\" @change=\"uploadImg\">\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            选择歌手\r            <n-select filterable multiple @update:value=\"update\" v-model:value=\"value\" :options=\"options\"/>\r        </n-space>\r        <n-space vertical item-style=\"min-width: 200px\">\r            歌词\r            <n-input type=\"textarea\" v-model:value=\"songDetail.lyric\"></n-input>\r        </n-space>\r        <n-space>\r            <n-button @click=\"updateSongDetail\">提交</n-button>\r        </n-space>\r    </n-space>\r</template>\r\r<script>\rimport notImage from '../assets/notImage.jpg'\rimport {NSpace, NInput, NAvatar, NButton, useMessage, NSelect} from 'naive-ui'\rimport {useRoute} from 'vue-router'\rimport {getCurrentInstance, onMounted, reactive, ref} from 'vue'\rimport request from '../utils/request'\r\rexport default {\r    name: 'AdminSongUpdate',\r    components: {NSpace, NInput, NAvatar, NButton, NSelect},\r    setup() {\r        const route = useRoute()\r        let file;\r        let message = useMessage()\r        let songDetail = ref({\r            id: '',\r            name: '',\r            imgSrc: '',\r        })\r        let singers = []\r        let options = reactive([])\r        let value = reactive([])\r\r        let id = route.query.id\r\r        function init() {\r            request.get('/singer/list').then(res => {\r                if (res.data.code === 0){\r                    for (let i = 0; i < res.data.data.length; i++) {\r                        options.push({\r                            label: res.data.data[i].name,\r                            value: res.data.data[i].id,\r                        })\r                    }\r                    singers = res.data.data\r                }\r            })\r        }\r\r        onMounted(() => {\r            init()\r            file = getCurrentInstance().refs.file\r            if (id !== undefined) {\r                request.get('/song/' + id).then(res => {\r                    if (res.data.code === 0) {\r                        songDetail.value = res.data.data\r                        for (let i = 0; i < singers.length; i++) {\r                            value.push(singers[i].id)\r                        }\r                    }\r                })\r            }\r        })\r\r        function uploadImg() {\r            if (!(file.files[0].type === \"image/png\") && !(file.files[0].type === \"image/jpeg\")) {\r                message.error(\"只能上传png/jpeg格式的图片文件，请重新上传\")\r                return false\r            }\r            if (!(file.files[0].size / 1024 / 1024 < 2)) {\r                message.error('上传头像图片大小不能超过 2MB!');\r                return false\r            }\r            const param = new FormData()\r            param.append('file', file.files[0])\r            request.post('/file/uploadAvatar', param, {headers: {\"Content-Type\": \"multipart/form-data\"}}).then(res => {\r                if (res.data.code === 0) {\r                    songDetail.value.imgSrc = res.data.data\r                }\r            })\r        }\r\r        function chooseImg() {\r            file.click()\r        }\r\r        function updateSongDetail() {\r            let singerList = []\r            console.log(singers)\r            for (let i = 0; i < value.length; i++) {\r                singerList.push(singers.find(item => {\r                    return item.id === value[i]\r                }))\r            }\r            songDetail.value.singers = singerList\r            request.post('/admin/song/update', songDetail.value).then(res => {\r                if (res.data.code === 0) {\r                    message.success('修改成功')\r                } else {\r                    message.error(res.data.msg)\r                }\r            })\r        }\r\r        function update(val) {\r            value.length = 0\r            value.push(...val)\r        }\r\r        return {\r            notImage,\r            songDetail,\r            options,\r            value,\r\r            chooseImg,\r            uploadImg,\r            update,\r            updateSongDetail,\r        }\r    }\r}\r</script>\r\r<style scoped>\r.hidden {\r    display: none;\r}\r</style>\rss\r","import { render } from \"./AdminSongUpdate.vue?vue&type=template&id=44059161&scoped=true\"\nimport script from \"./AdminSongUpdate.vue?vue&type=script&lang=js\"\nexport * from \"./AdminSongUpdate.vue?vue&type=script&lang=js\"\n\nimport \"./AdminSongUpdate.vue?vue&type=style&index=0&id=44059161&scoped=true&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\xck\\\\Desktop\\\\music-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-44059161\"]])\n\nexport default __exports__"],"sourceRoot":""}